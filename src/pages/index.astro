---
import "../styles/global.css";
import NavbarAuth from "../components/ui/NavbarAuth.astro";
import ScrollArrow from "../components/ui/ScrollArrow.astro";
---

<!doctype html>
<html lang="it">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Benvenuto nel nostro sito web" />
        <meta name="keywords" content="sito web, servizi, contatti" />
        <title>Dai Vai</title>

        <!-- Favicon per tutti i browser e dispositivi -->
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/daivai/favicon/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/daivai/favicon/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/daivai/favicon/favicon-16x16.png"
        />
        <link rel="manifest" href="/daivai/favicon/site.webmanifest" />
        <link rel="shortcut icon" href="/daivai/favicon/favicon.ico" />

        <!-- Favicon SVG per browser moderni -->
        <link
            rel="icon"
            type="image/svg+xml"
            href="/daivai/images/DaiVai.svg"
        />

        <link
            rel="preload"
            href="/daivai/fonts/condenso/Condenso-Regular.woff2"
            as="font"
            type="font/woff2"
            crossorigin
        />

        <!-- Meta tag per il theme color -->
        <meta name="theme-color" content="#FB6068" />

        <!-- CSS Imported in frontmatter -->
    </head>
    <body>
        <NavbarAuth />
        <main>
            <div class="container">
                <section id="hero"></section>
                <section id="logo-overlay">
                    <img
                        src="/daivai/images/DaiVai-Yellow.svg"
                        alt="Daivai Logo"
                        class="hero-image"
                    />
                </section>
                <section id="hero-overlay">
                    <img
                        src="/daivai/images/chiodo.png"
                        alt="Chiodo"
                        class="hero-image"
                    />
                    <div id="unisciti-text" class="unisciti-text condenso-text">
                        UNISCITI!
                    </div>
                </section>
            </div>
        </main>

        <section class="viewport-section">
            <div class="text-gradient-wrapper">
                <div class="gradient-text-group">
                    <h2 class="condenso-text">COSA</h2>
                    <h2 class="condenso-text">SIAMO?</h2>
                </div>
                <ScrollArrow class="arrow-icon" />
                <p class="info-paragraph">
                    Siamo un'associazione culturale no-profit di giovani
                    intenzionati a creare un impatto positivo sul territorio
                    veronese attraverso lo sport.
                </p>
            </div>
        </section>

        <section class="viewport-section-mirrored"></section>

        <script src="/daivai/js/script.js" is:inline></script>
        <script>
            // Auto-resize Condenso text to 75% viewport width
            function resizeCondensoText() {
                const wrapper = document.querySelector(
                    ".text-gradient-wrapper",
                );
                const elements = document.querySelectorAll(".condenso-text");
                // Use document.documentElement.clientWidth for viewport width excluding scrollbar
                const viewportWidth = document.documentElement.clientWidth;
                const targetWidth = viewportWidth * 0.75;

                // Calculate total height of the wrapper for the gradient
                let wrapperHeight = 0;
                let wrapperTop = 0;

                if (wrapper instanceof HTMLElement) {
                    wrapperHeight = wrapper.offsetHeight;
                    wrapperTop = wrapper.getBoundingClientRect().top;
                }

                elements.forEach((el) => {
                    if (!(el instanceof HTMLElement)) return;

                    // Reset to a known base size to measure relative width
                    // Using a large size minimizes rounding errors
                    el.style.fontSize = "100px";
                    el.style.width = "fit-content";
                    el.style.maxWidth = "none"; // CRITICAL: prevent capping by CSS

                    const currentWidth = el.offsetWidth;

                    if (currentWidth > 0) {
                        const ratio = targetWidth / currentWidth;
                        const newFontSize = 100 * ratio;
                        el.style.fontSize = `${newFontSize}px`;
                        // Remove width override so CSS can re-apply if needed, though font-size drives it now
                        el.style.width = "";
                        el.style.maxWidth = "";
                    }
                });
            }

            // Function to apply gradient based on the text group height
            window.addEventListener("resize", () => {
                resizeCondensoText();
            });
            window.addEventListener("load", () => {
                resizeCondensoText();
            });
            if (document.fonts) {
                document.fonts.ready.then(() => {
                    resizeCondensoText();
                });
            }
        </script>
    </body>
</html>
